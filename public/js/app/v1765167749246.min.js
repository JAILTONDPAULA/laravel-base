class Request{static call(t,e,a,o=null,i=!0,s={},n="json"){$.ajax({url:t,type:e,type:e,dataType:n,data:a,headers:s,beforeSend(){i&&Preload.show()},error(t,e,a){401!==t.status||["/login","/senha"].includes(location.pathname)?(Preload.hide(),Toast.error("Erro na Requisição: "+t.responseText,!0)):location.href="/login"},success(t,e,a){o&&o(t,a.status)}})}}let typingTimer,typingDelay=300;$(document).ready(function(){$(document).on("click",".linha>div>svg",Tabela.ordem.selecionar),$(document).on("input paste",".searchbox",function(){clearTimeout(typingTimer),typingTimer=setTimeout(()=>{Tabela.buscador.filtrar.call(this)},typingDelay)}),$(document).on("input paste",".coringa",Tabela.buscador.selecionaTodos),$(document).on("change",".listbox input:not(.coringa)",Tabela.buscador.filtrarCk),$(document).on("click",function(t){var t=$(t.target),e=t.closest(".cl_filtro");e.length?($(".cl_filtro").not(e).find(".boxfilter").css({height:"0px",padding:"0px","box-shadow":"none"}),t.is(".boxfilter *")||t.closest(".boxfilter").length||Tabela.buscador.mostrar.call(e[0])):$(".cl_filtro .boxfilter").css({height:"0px",padding:"0px","box-shadow":"none"})}),$(document).on("click","#download_xls",Tabela.download),$(document).on("click",".paginacao button.number",function(){Paginacao.selecionar(this)}),$(document).on("click",".paginacao .next",Paginacao.next),$(document).on("click",".paginacao .back",Paginacao.prev),$(document).on("click","#tabela01 .last",function(){Paginacao.last()}),$(document).on("click","#tabela01 .first",Paginacao.buttons),$(document).on("change","#quantitypage",Tabela.alterpage.change)}),Tabela=class{static download(){var t,e;window.xls&&Array.isArray(window.xls)&&0!==window.xls.length?(t=JSON.parse($(".tabela").data("linhas")).map(e=>{let a={};return window.xls.forEach(t=>{a[t.novoNome]=e[t.original]}),a}),t=XLSX.utils.json_to_sheet(t),e=XLSX.utils.book_new(),XLSX.utils.book_append_sheet(e,t,"Relatorio"),XLSX.writeFile(e,"relatorio.xlsx")):alert("XLS não configurado")}static func=t=>{alert("Função estática 'func' ainda não foi definida!")};static indicador=t=>null;static buscador={mostrar(){$(this).find(".boxfilter").css({height:"fit-content",padding:"2px","box-shadow":"1px 1px 1px 1px #0002"}).find("[type=tel]").focus()},ocultar(){let t=this;setTimeout(()=>{t.contains(document.activeElement)||$(t).find(".boxfilter").css({height:"0px",padding:"0px","box-shadow":"none"})},25)},filtrar(){var i=new RegExp(this.value,"i"),t=$(this).siblings(".listbox").find("label");$.each(t,(t,e)=>{var a="coringa"===$(e).find("input").data("prop"),o=$(e).find("input").val();a||i.test(o)?$(e).slideDown(200,function(){$(this).css({display:"flex"})}):$(e).slideUp(200)})},selecionaTodos(){$(this).closest(".listbox").find("input").prop("checked",this.checked),this.checked&&$(this).closest(".listbox").find("input:not(.coringa)").eq(0).trigger("change");let e=$(this).closest(".boxfilter").attr("id");window.filterorder=window.filterorder||[],window.filterorder=window.filterorder.filter(t=>t!==e)},filtrarCk(){var t=$(this).closest(".listbox").find("input:not(.coringa):checked").map((t,e)=>e.value).get(),t=($(this).closest(".boxfilter").data("valores",t),$(this).closest(".listbox").find("input:not(.coringa)").length),e=$(this).closest(".listbox").find("input:not(.coringa):checked").length,a=$(this).closest(".boxfilter").attr("id");window.filterorder=window.filterorder||[],window.filterorder.includes(a)||window.filterorder.push(a),e<t?$(this).closest(".cl_filtro").find("div>svg,>span").css({background:"var(--p-orange-500)"}):($(this).closest(".cl_filtro").find("div>svg").css({background:"#0000"}),$(this).closest(".cl_filtro").find(">span").css({background:"#0000"})),Tabela.buscador.filtrarline()},filtrarline(t=null){let n=JSON.parse($(".tabela").data("original")),r=(Tabela.buscador.ordernador(),n);window.ordemfinal.map((t,e)=>{let a=$("#"+t).data("prop"),o=$("#"+t).data("valores"),i=(r=Array.isArray(o)?0<o.length?r.filter(e=>o.some(t=>t==(e[a]||"null"))):[]:r)?r.map(t=>t[a]):[];var s=[...new Set(n.map(t=>t[a]))].sort().map(e=>`<label><input type="checkbox" value="${e}" ${i.some(t=>t==e)?"checked":""}>${e}</label>`).join("");parseInt($("#"+t).css("height"))<=2&&$(`#${t} .listbox`).html(`<label><input type="checkbox" value="&" class="coringa" ${n.length===r.length?"checked":""}></label>`+s),n=r}),r=window.criterio?Tabela.ordem.ordenarPorCriterios(r,window.criterio):r,$(".tabela").data("linhas",JSON.stringify(r)),Tabela.indicador(),t||($(".tabela .linha:not(.cabecalho)").remove(),Paginacao.buttons()),t?$(".idline"+t).fadeOut(200).fadeIn(200).fadeOut(200).fadeIn(200):Paginacao.buttons(),Tabela.buscador.contador(r)},contador(r){window.contadores.forEach(t=>{let[e,a,o,i]=t,s=0;switch(e){case"Q":var n=new Set(r.map(t=>t[a]));s=n.size;break;case"P":s=void 0===i?(console.warn(`Tipo P requer um valor para filtrar. Contador: [${t.join(", ")}]`),0):r.filter(t=>t[a]===i).length;break;case"S":s=r.reduce((t,e)=>t+(parseFloat(e[a])||0),0);break;case"R":s=(s=r.reduce((t,e)=>t+(parseFloat(e[a])||0),0)).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});break;default:return void console.warn(`Tipo ${e} não reconhecido.`)}$(o).text(s)})},ordernador(){window.ordemfinal=[],window.filterorder=window.filterorder||[];var t,e,a=new Set;for(t of window.filterorder)window.filterorigin.includes(t)&&!a.has(t)&&(window.ordemfinal.push(t),a.add(t));for(e of window.filterorigin)a.has(e)||window.ordemfinal.push(e)}};static ordem={selecionar(t){t.stopPropagation(),window.criterio=window.criterio||[];let e=this.dataset.chave;var t=window.criterio.findIndex(t=>t.chave===e),a=JSON.parse($(".tabela").data("linhas")),t=($(this).is(".asc")?($(this).replaceWith(`<svg xmlns="http://www.w3.org/2000/svg" data-chave="${e}" class="desc" height="16px" viewBox="0 -960 960 960" width="16px" fill="var(--p-orange-500)"><path d="M412-114v-470L210-383l-96-97 366-366 366 366-96 98-202-202v470H412Z"/></svg>`),-1===t?window.criterio.push({chave:e,ordem:"desc"}):window.criterio[t].ordem="desc"):$(this).is(".desc")?($(this).replaceWith(`<svg xmlns="http://www.w3.org/2000/svg" data-chave="${e}" height="16px" viewBox="0 -960 960 960" width="16px" fill="#fff"><path d="M86-172v-125h291v125H86Zm0-245v-125h539v125H86Zm0-245v-125h788v125H86Z"/></svg>`),-1!==t&&window.criterio.splice(t,1)):($(this).replaceWith(`<svg xmlns="http://www.w3.org/2000/svg" data-chave="${e}" class="asc" height="16px" viewBox="0 -960 960 960" width="16px" fill="var(--p-orange-500)"><path d="M412-114v-470L210-383l-96-97 366-366 366 366-96 98-202-202v470H412Z"/></svg>`),-1===t?window.criterio.push({chave:e,ordem:"asc"}):window.criterio[t].ordem="asc"),Tabela.ordem.ordenarPorCriterios(a,window.criterio));$(".tabela").data("linhas",JSON.stringify(t)),$(".tabela .linha:not(.cabecalho)").remove(),Paginacao.buttons()},ordenarPorCriterios(t,e){return t.sort((a,o)=>{for(var i of e){var{chave:i,ordem:s}=i;let t=a[i],e=o[i];i=t=>null==t;if(!i(t)||!i(e)){if(i(t))return"asc"===s?1:-1;if(i(e))return"asc"===s?-1:1;var i=t=>"string"==typeof t&&/^\d{4}-\d{2}-\d{2}( \d{2}:\d{2}:\d{2})?$/.test(t),n=t=>"number"==typeof t&&!isNaN(t)||"string"==typeof t&&/^-?\d+(\.\d+)?$/.test(t)&&!isNaN(parseFloat(t));if(i(t)&&i(e)?(t=new Date(t),e=new Date(e)):n(t)&&n(e)?(t=parseFloat(t),e=parseFloat(e)):("string"==typeof t&&(t=t.toLowerCase()),"string"==typeof e&&(e=e.toLowerCase())),t<e)return"asc"===s?-1:1;if(t>e)return"asc"===s?1:-1}}return 0})}};static alterpage={change(){Paginacao.itens="all"===$(this).val()?JSON.parse($(".tabela").data("original")).length:parseInt($(this).val()),Tabela.buscador.filtrarline()}}},Paginacao=class{static itens=50;static buttons(){var t=JSON.parse($(".tabela").data("linhas")),e=($("#tabela01").find("button.number").remove(),""),a=10<t.length/Paginacao.itens?10:t.length/Paginacao.itens;for(let t=0;t<a;t++)e+=`<button type="button" class="number">${t+1}</button>`;$("#tabela01").find("button.back").after(e),$("#tabela01 button.number").eq(0).addClass("selected"),Paginacao.selecionar($("button.number").eq(0)[0])}static selecionar(t){var e=JSON.parse($(".tabela").data("linhas")),a=($(t).closest(".paginacao").find("button.number").removeClass("selected"),$(t).addClass("selected"),parseInt($(t).text())<e.length/Paginacao.itens&&$(t).next().is(".next")?($(t).after(`<button type="button" class="number">${parseInt($(t).text())+1}</button>`),$(t).closest(".paginacao").find(".back").next().remove()):$(t).prev().is(".back")&&"1"!=$(t).text()&&($(t).closest(".paginacao").find(".back").after(`<button type="button" class="number">${parseInt($(t).text())-1}</button>`),$(t).closest(".paginacao").find(".next").prev().remove()),(parseInt($(t).text())-1)*Paginacao.itens),o=e.slice(a,a+Paginacao.itens);$(t).closest(".paginacao").find(".first,.back").prop("disabled","1"==$(t).text()),$(t).closest(".paginacao").find("span").text(`${1+a} até ${a+o.length} de `+e.length),$(".tabela").find(".linha:not(.cabecalho)").remove(),$(".tabela").append(o.map(Tabela.func).join(""))}static last(){$("#tabela01").find("button.number").remove();var t=JSON.parse($(".tabela").data("linhas")),e="",a=Math.ceil(t.length/Paginacao.itens)<=10?Math.ceil(t.length/Paginacao.itens):10,o=Math.ceil(t.length/Paginacao.itens);for(let t=0;t<a;t++)e=`<button type="button" class="number">${o}</button>`+e,o--;$("#tabela01").find("button.back").after(e),$("#tabela01 button.number").eq(-1).addClass("selected").trigger("click")}static next(){$(this).closest(".paginacao").find(".selected").next().trigger("click")}static prev(){$(this).closest(".paginacao").find(".selected").prev().trigger("click")}};class Preload{static show(){$("body").css("overflow","hidden"),$(".preload").css("display","flex")}static hide(){$(".preload").css("display","none"),$("body").css("overflow","auto")}}class Dialog{static show(t="Título",e="Mensagem",a="",o=null){var i="dialog-"+Date.now(),a=`
            <section class="dialog ${a}" id="${i}">
                <form class="dialog-form">
                    <div class="dialog-form-header">
                        <h2 class="dialog-form-header-title">${t}</h2>
                        <span class="dialog-close">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor">
                                <path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/>
                            </svg>
                        </span>
                    </div>
                    <div class="dialog-form-body">
                        ${e}
                    </div>
                    <div class="dialog-form-footer">
                        <button type="button" class="dialog-close">Fechar</button>
                        ${o?`<button type="submit">${o}</button>`:""}
                    </div>
                </form>
            </section>
        `;return $("body").addClass("dialog-open").append(a),i}static success(t,e,a=null,o=""){return Dialog.show(t,e,"dialog-success "+o,a)}static error(t,e,a=null,o=""){return Dialog.show(t,e,"dialog-error "+o,a)}static alert(t,e,a=null,o=""){return Dialog.show(t,e,"dialog-alert "+o,a)}}$(document).on("click",".dialog-close",function(){let t=$(this).closest(".dialog");var e=t.find(".dialog-form");t.css("animation","dialog-fade-out 0.3s ease-out"),e.css("animation","dialog-slide-down 0.3s ease-out"),setTimeout(()=>{t.remove(),0===$(".dialog").length&&$("body").removeClass("dialog-open")},300)}),$(document).on("click",".dialog",function(t){t.target===this&&$(this).find(".dialog-close").first().click()});class Toast{static containerSelector=".toast-container";static types={success:"toast-success",error:"toast-error",alert:"toast-alert",neutral:"toast-neutral"};static show(t,e="neutral",a=!1){if(!document.querySelector(Toast.containerSelector)){let t=document.createElement("div");t.className="toast-container",document.body.appendChild(t)}let o=document.querySelector(Toast.containerSelector),i=document.createElement("div");i.className="toast "+(Toast.types[e]||Toast.types.neutral);e=document.createElement("span"),e.textContent=t,i.appendChild(e),t=document.createElement("button");t.className="toast-close",t.innerHTML="&times;",t.onclick=()=>i.remove(),i.appendChild(t),o.appendChild(i),a||setTimeout(()=>{i.remove()},3500)}static success(t,e=!1){Toast.show(t,"success",e)}static error(t,e=!1){Toast.show(t,"error",e)}static alert(t,e=!1){Toast.show(t,"alert",e)}static neutral(t,e=!1){Toast.show(t,"neutral",e)}}